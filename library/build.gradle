apply plugin: 'android-library'
apply plugin: 'maven-publish'
//apply plugin: 'android-maven'

android {
    compileSdkVersion 'android-L'
    buildToolsVersion "20.0.0"

    publishNonDefault true

    defaultPublishConfig "release"

    defaultConfig {
        applicationId "com.zunk.android.nosql"
        minSdkVersion 7
        targetSdkVersion 20
        versionCode 1
        versionName "1.0"
    }

    lintOptions {
        abortOnError false
    }

    buildTypes {
        release {
            runProguard false
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
        }
    }
}

repositories {
    maven { url "http://files.couchbase.com/maven2/" }
    mavenLocal()
    mavenCentral()
}

dependencies {
    compile 'com.couchbase.lite:couchbase-lite-android:+'
    compile 'com.google.code.gson:gson:+'
    compile 'com.loopj.android:android-async-http:+'
}

uploadArchives {
    repositories {
        flatDir {
            dirs "$buildDir/release"
        }
    }
}

/*
task sourceJar(type: Jar) {
    from sourceSets.main.allJava
}
*/

/*
publishing {
    publications {
        mavenJava(MavenPublication) {
            groupId 'org.gradle.sample'
            artifactId 'project1-sample'

            from components.java

            artifact sourceJar {
                classifier "sources"
            }
        }

        repositories {
            maven {
                url "$buildDir/"
            }
        }
    }
}
*/

/*
task installArchives(type: Upload) {
    description "Installs the artifacts to the local Maven repository."
    configuration = configurations['archives']
    repositories {
        mavenDeployer {
            repository url: "file://${System.properties['user.home']}/.m2/repository"
        }
    }
}
*/

// load bundleRelease task
// this will not load the task in 0.5.5
android.libraryVariants

task androidReleaseJar(type: Jar, dependsOn: assembleRelease) {
    from "$buildDir/intermediates/classes/release/"
}

publishing {
    publications {
        maven(MavenPublication) {
            groupId 'com.zunck.anroid'
            artifactId 'android-sync-nosql'
            version '1.0.1'

            artifact androidReleaseJar
        }
    }
    repositories{
        maven{
            url "$buildDir/"
        }
    }
}